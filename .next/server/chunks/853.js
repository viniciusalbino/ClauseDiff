"use strict";exports.id=853,exports.ids=[853],exports.modules={4853:(e,t,i)=>{i.d(t,{recordLoginFailure:()=>o}),i(87070),i(20330);let s={rateLimit:{enabled:!0,windowMs:9e5,maxRequests:100,authWindowMs:3e5,authMaxRequests:10,loginWindowMs:9e5,loginMaxAttempts:5,progressiveBackoff:{enabled:!0,baseDelayMs:1e3,maxDelayMs:3e4,multiplier:2}}},a=new Map,l=[];function o(e){let t=a.get(e);if(!t)return;t.failures++;let i=s.rateLimit.progressiveBackoff;if(i.enabled&&t.failures>=3){let s=Math.min(i.baseDelayMs*Math.pow(i.multiplier,t.failures-3),i.maxDelayMs);t.backoffUntil=Date.now()+s,function(e,t,i={}){let s={timestamp:Date.now(),ip:e,event:t,details:i};l.push(s),console.log(`[SECURITY] ${t}:`,JSON.stringify({timestamp:new Date(s.timestamp).toISOString(),ip:e,...i})),l.length>1e3&&l.splice(0,l.length-1e3)}(e,"LOGIN_PROGRESSIVE_BACKOFF_APPLIED",{failures:t.failures,backoffMs:s})}}}};