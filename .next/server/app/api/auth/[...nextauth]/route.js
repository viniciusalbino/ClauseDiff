"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/auth/[...nextauth]/route";
exports.ids = ["app/api/auth/[...nextauth]/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "assert":
/*!*************************!*\
  !*** external "assert" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("assert");

/***/ }),

/***/ "buffer":
/*!*************************!*\
  !*** external "buffer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("buffer");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "querystring":
/*!******************************!*\
  !*** external "querystring" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("querystring");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "zlib":
/*!***********************!*\
  !*** external "zlib" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("zlib");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Fviniciusalbino%2FDocuments%2FGitHub%2Fclausediff.nosync%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fviniciusalbino%2FDocuments%2FGitHub%2Fclausediff.nosync&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Fviniciusalbino%2FDocuments%2FGitHub%2Fclausediff.nosync%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fviniciusalbino%2FDocuments%2FGitHub%2Fclausediff.nosync&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_viniciusalbino_Documents_GitHub_clausediff_nosync_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/auth/[...nextauth]/route.ts */ \"(rsc)/./app/api/auth/[...nextauth]/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/auth/[...nextauth]/route\",\n        pathname: \"/api/auth/[...nextauth]\",\n        filename: \"route\",\n        bundlePath: \"app/api/auth/[...nextauth]/route\"\n    },\n    resolvedPagePath: \"/Users/viniciusalbino/Documents/GitHub/clausediff.nosync/app/api/auth/[...nextauth]/route.ts\",\n    nextConfigOutput,\n    userland: _Users_viniciusalbino_Documents_GitHub_clausediff_nosync_app_api_auth_nextauth_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/auth/[...nextauth]/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdXRoJTJGJTVCLi4ubmV4dGF1dGglNUQlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF1dGglMkYlNUIuLi5uZXh0YXV0aCU1RCUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnZpbmljaXVzYWxiaW5vJTJGRG9jdW1lbnRzJTJGR2l0SHViJTJGY2xhdXNlZGlmZi5ub3N5bmMlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRlVzZXJzJTJGdmluaWNpdXNhbGJpbm8lMkZEb2N1bWVudHMlMkZHaXRIdWIlMkZjbGF1c2VkaWZmLm5vc3luYyZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDNEM7QUFDekg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jbGF1c2VkaWZmLS0tZG9jdW1lbnQtY29tcGFyaXNvbi10b29sLz8wNWQ0Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy92aW5pY2l1c2FsYmluby9Eb2N1bWVudHMvR2l0SHViL2NsYXVzZWRpZmYubm9zeW5jL2FwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF1cIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIi9Vc2Vycy92aW5pY2l1c2FsYmluby9Eb2N1bWVudHMvR2l0SHViL2NsYXVzZWRpZmYubm9zeW5jL2FwcC9hcGkvYXV0aC9bLi4ubmV4dGF1dGhdL3JvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Fviniciusalbino%2FDocuments%2FGitHub%2Fclausediff.nosync%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fviniciusalbino%2FDocuments%2FGitHub%2Fclausediff.nosync&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/auth/[...nextauth]/route.ts":
/*!*********************************************!*\
  !*** ./app/api/auth/[...nextauth]/route.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ handler),\n/* harmony export */   POST: () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next-auth */ \"(rsc)/./node_modules/next-auth/index.js\");\n/* harmony import */ var next_auth__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_auth__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next-auth/providers/google */ \"(rsc)/./node_modules/next-auth/providers/google.js\");\n/* harmony import */ var next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next-auth/providers/credentials */ \"(rsc)/./node_modules/next-auth/providers/credentials.js\");\n/* harmony import */ var _next_auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @next-auth/prisma-adapter */ \"(rsc)/./node_modules/@next-auth/prisma-adapter/dist/index.js\");\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @/lib/prisma */ \"(rsc)/./src/lib/prisma.ts\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! bcryptjs */ \"(rsc)/./node_modules/bcryptjs/index.js\");\n/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(bcryptjs__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var zod__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! zod */ \"(rsc)/./node_modules/zod/dist/esm/index.js\");\n/**\n * Auth route para autenticação com NextAuth v4 (Next.js 14 App Router).\n *\n * POLÍTICA DE AUDITORIA E LOGGING:\n * - Este endpoint implementa logging/auditoria de eventos de autenticação (login, logout, falha, etc.)\n *   para fins de segurança, rastreabilidade e compliance (LGPD/GDPR).\n * - O logging é controlado pela feature flag de ambiente AUDIT_LOGGING_ENABLED.\n *   - Para ativar: defina AUDIT_LOGGING_ENABLED=on no .env\n *   - Por padrão, o log está DESLIGADO para evitar custos/desempenho no MVP.\n * - Os eventos são registrados na tabela AuditLog do banco via Prisma.\n * - Falhas no log NÃO afetam o fluxo de autenticação.\n *\n * Para ativar o login Google OAuth, defina GOOGLE_CLIENT_ID e GOOGLE_CLIENT_SECRET no .env\n * Exemplo:\n *   GOOGLE_CLIENT_ID=xxxx.apps.googleusercontent.com\n *   GOOGLE_CLIENT_SECRET=xxxx\n */ \n\n\n\n // Use singleton Prisma instance\n\n\nconst credentialsSchema = zod__WEBPACK_IMPORTED_MODULE_6__.z.object({\n    email: zod__WEBPACK_IMPORTED_MODULE_6__.z.string().email(),\n    password: zod__WEBPACK_IMPORTED_MODULE_6__.z.string().min(6)\n});\n// JWT token configuration for security and rotation\nconst JWT_MAX_AGE = 15 * 60; // 15 minutes - short-lived access tokens for security\nconst JWT_REFRESH_THRESHOLD = 5 * 60; // 5 minutes - refresh when 5 minutes left\nconst SESSION_MAX_AGE = 30 * 24 * 60 * 60; // 30 days - long-lived session\nconst SESSION_UPDATE_AGE = 24 * 60 * 60; // 24 hours - update session daily\nconst authOptions = {\n    adapter: (0,_next_auth_prisma_adapter__WEBPACK_IMPORTED_MODULE_3__.PrismaAdapter)(_lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma),\n    providers: [\n        (0,next_auth_providers_credentials__WEBPACK_IMPORTED_MODULE_2__[\"default\"])({\n            name: \"Email e Senha\",\n            credentials: {\n                email: {\n                    label: \"Email\",\n                    type: \"email\",\n                    placeholder: \"seu@email.com\"\n                },\n                password: {\n                    label: \"Senha\",\n                    type: \"password\"\n                }\n            },\n            async authorize (credentials) {\n                const parsed = credentialsSchema.safeParse(credentials);\n                if (!parsed.success) {\n                    throw new Error(\"Credenciais inv\\xe1lidas\");\n                }\n                const { email, password } = parsed.data;\n                const user = await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.findUnique({\n                    where: {\n                        email\n                    }\n                });\n                if (!user || !user.password) {\n                    throw new Error(\"Usu\\xe1rio ou senha inv\\xe1lidos\");\n                }\n                const isValid = await bcryptjs__WEBPACK_IMPORTED_MODULE_5___default().compare(password, user.password);\n                if (!isValid) {\n                    throw new Error(\"Usu\\xe1rio ou senha inv\\xe1lidos\");\n                }\n                // Return object must match NextAuth.User (augmented via types.ts)\n                return {\n                    id: user.id,\n                    email: user.email,\n                    name: user.name || `${user.firstName || \"\"} ${user.lastName || \"\"}`.trim() || null,\n                    image: user.image,\n                    // Include other fields from augmented User type if available directly\n                    firstName: user.firstName,\n                    lastName: user.lastName,\n                    emailVerified: user.emailVerified,\n                    role: user.role\n                };\n            }\n        }),\n        ...process.env.GOOGLE_CLIENT_ID && process.env.GOOGLE_CLIENT_SECRET ? [\n            (0,next_auth_providers_google__WEBPACK_IMPORTED_MODULE_1__[\"default\"])({\n                clientId: process.env.GOOGLE_CLIENT_ID,\n                clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n                authorization: {\n                    params: {\n                        scope: \"openid email profile\"\n                    }\n                },\n                // Use RawGoogleProfile for the input 'profile' parameter.\n                // The return type must conform to our augmented NextAuth.User type.\n                profile (profile) {\n                    // console.log(\"Google Profile in GoogleProvider.profile: \", profile);\n                    return {\n                        id: profile.sub,\n                        name: profile.name || null,\n                        email: profile.email,\n                        image: profile.picture || null,\n                        // These are the custom fields we added to our NextAuth.User type\n                        emailVerified: profile.email_verified ? new Date() : null,\n                        firstName: profile.given_name || null,\n                        lastName: profile.family_name || null\n                    };\n                }\n            })\n        ] : []\n    ],\n    session: {\n        strategy: \"jwt\",\n        maxAge: SESSION_MAX_AGE,\n        updateAge: SESSION_UPDATE_AGE\n    },\n    jwt: {\n        maxAge: JWT_MAX_AGE\n    },\n    pages: {\n        signIn: \"/login\",\n        error: \"/login\"\n    },\n    // Enhanced CSRF protection configuration\n    useSecureCookies: \"development\" === \"production\",\n    cookies: {\n        sessionToken: {\n            name: `${ false ? 0 : \"\"}next-auth.session-token`,\n            options: {\n                httpOnly: true,\n                sameSite: \"strict\",\n                path: \"/\",\n                secure: \"development\" === \"production\"\n            }\n        },\n        callbackUrl: {\n            name: `${ false ? 0 : \"\"}next-auth.callback-url`,\n            options: {\n                httpOnly: true,\n                sameSite: \"strict\",\n                path: \"/\",\n                secure: \"development\" === \"production\"\n            }\n        },\n        csrfToken: {\n            name: `${ false ? 0 : \"\"}next-auth.csrf-token`,\n            options: {\n                httpOnly: false,\n                sameSite: \"strict\",\n                path: \"/\",\n                secure: \"development\" === \"production\"\n            }\n        }\n    },\n    callbacks: {\n        // Use the standard NextAuth callback signature\n        async signIn ({ user, account, profile }) {\n            // For Google OAuth, update user with latest info from Google profile if needed.\n            // The 'user' object here should already have an 'id' if it's an existing user or newly created by adapter.\n            if (account?.provider === \"google\" && profile && user.id) {\n                const googleProfile = profile;\n                // Update user with latest info from Google profile\n                const dataToUpdate = {}; // Use any to avoid Prisma type issues\n                if (googleProfile.picture && googleProfile.picture !== user.image) dataToUpdate.image = googleProfile.picture;\n                const profileEmailVerified = googleProfile.email_verified ? new Date() : null;\n                const userEmailVerified = user.emailVerified;\n                // Compare dates properly or always update if different\n                if (profileEmailVerified?.getTime() !== (userEmailVerified instanceof Date ? userEmailVerified.getTime() : null)) {\n                    dataToUpdate.emailVerified = profileEmailVerified;\n                }\n                if (googleProfile.given_name && googleProfile.given_name !== user.firstName) dataToUpdate.firstName = googleProfile.given_name;\n                if (googleProfile.family_name && googleProfile.family_name !== user.lastName) dataToUpdate.lastName = googleProfile.family_name;\n                // Update 'name' field if different\n                if (googleProfile.name && googleProfile.name !== user.name) {\n                    dataToUpdate.name = googleProfile.name;\n                }\n                if (Object.keys(dataToUpdate).length > 0) {\n                    try {\n                        await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.update({\n                            where: {\n                                id: user.id\n                            },\n                            data: dataToUpdate\n                        });\n                    } catch (error) {\n                        console.error(\"Error updating user in signIn callback:\", error);\n                    }\n                }\n            }\n            return true; // Allow sign in\n        },\n        async jwt ({ token, user }) {\n            const now = Math.floor(Date.now() / 1000);\n            // If it's a new user or new sign-in, 'user' object will be available.\n            if (user?.id) {\n                // Fresh login - set initial token data\n                token.id = user.id;\n                token.iat = now;\n                token.exp = now + JWT_MAX_AGE;\n                // Fetch the complete user from DB to ensure all fields are fresh, especially 'role'.\n                const dbUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.findUnique({\n                    where: {\n                        id: user.id\n                    }\n                });\n                if (dbUser) {\n                    token.name = dbUser.name || `${dbUser.firstName || \"\"} ${dbUser.lastName || \"\"}`.trim() || null;\n                    token.email = dbUser.email;\n                    token.picture = dbUser.image;\n                    token.role = dbUser.role;\n                    token.firstName = dbUser.firstName;\n                    token.lastName = dbUser.lastName;\n                    token.emailVerified = dbUser.emailVerified;\n                } else {\n                    // Fallback to user object if dbUser not found\n                    token.name = user.name || null;\n                    token.email = user.email || null;\n                    token.picture = user.image || null;\n                    token.role = user.role || null;\n                    token.firstName = user.firstName || null;\n                    token.lastName = user.lastName || null;\n                    token.emailVerified = user.emailVerified || null;\n                }\n                return token;\n            }\n            // Token rotation logic: Check if token is close to expiry and refresh if needed\n            const timeUntilExpiry = token.exp - now;\n            if (timeUntilExpiry < JWT_REFRESH_THRESHOLD) {\n                console.log(\"JWT token is close to expiry, rotating...\", {\n                    currentTime: now,\n                    tokenExp: token.exp,\n                    timeUntilExpiry,\n                    threshold: JWT_REFRESH_THRESHOLD\n                });\n                // Rotate the token by creating a new one with fresh expiry\n                const newToken = {\n                    ...token,\n                    iat: now,\n                    exp: now + JWT_MAX_AGE\n                };\n                // Refresh user data from database to ensure it's current\n                if (token.id) {\n                    try {\n                        const dbUser = await _lib_prisma__WEBPACK_IMPORTED_MODULE_4__.prisma.user.findUnique({\n                            where: {\n                                id: token.id\n                            }\n                        });\n                        if (dbUser) {\n                            newToken.name = dbUser.name || `${dbUser.firstName || \"\"} ${dbUser.lastName || \"\"}`.trim() || null;\n                            newToken.email = dbUser.email;\n                            newToken.picture = dbUser.image;\n                            newToken.role = dbUser.role;\n                            newToken.firstName = dbUser.firstName;\n                            newToken.lastName = dbUser.lastName;\n                            newToken.emailVerified = dbUser.emailVerified;\n                        }\n                    } catch (error) {\n                        console.error(\"Error refreshing user data during token rotation:\", error);\n                    // Continue with existing token data if DB fetch fails\n                    }\n                }\n                console.log(\"JWT token rotated successfully\", {\n                    oldExp: token.exp,\n                    newExp: newToken.exp,\n                    newIat: newToken.iat\n                });\n                return newToken;\n            }\n            // Token is still valid, return as-is\n            return token;\n        },\n        async session ({ session, token }) {\n            // Send properties to the client, like id and any custom user properties.\n            if (token && session.user) {\n                session.user.id = token.id;\n                session.user.name = token.name;\n                session.user.email = token.email;\n                session.user.image = token.picture;\n                session.user.role = token.role;\n                session.user.firstName = token.firstName;\n                session.user.lastName = token.lastName;\n                session.user.emailVerified = token.emailVerified;\n                // Add JWT metadata for debugging in development\n                if (true) {\n                    session.debug = {\n                        tokenIat: token.iat,\n                        tokenExp: token.exp,\n                        timeUntilExpiry: token.exp ? token.exp - Math.floor(Date.now() / 1000) : undefined\n                    };\n                }\n            }\n            return session;\n        },\n        async redirect ({ url, baseUrl }) {\n            const parsedUrl = new URL(url, baseUrl);\n            console.log(`Redirect callback: URL='${url}', BaseURL='${baseUrl}', Pathname='${parsedUrl.pathname}'`);\n            // If we're being redirected to /login with error=Callback, but authentication was successful,\n            // redirect to success page instead. The \"Callback\" error sometimes appears even on successful auth.\n            if (parsedUrl.pathname === \"/login\" && parsedUrl.searchParams.get(\"error\") === \"Callback\") {\n                console.log(\"Redirecting to success page despite Callback error\");\n                return `${baseUrl}/success`;\n            }\n            // If we're being redirected to /login without explicit errors, go to success\n            if (parsedUrl.pathname === \"/login\" && !parsedUrl.searchParams.has(\"error\")) {\n                console.log(\"Redirecting to success page from login\");\n                return `${baseUrl}/success`;\n            }\n            // For any other redirect to login with real errors, allow it\n            if (parsedUrl.pathname === \"/login\" && parsedUrl.searchParams.has(\"error\")) {\n                console.log(\"Allowing redirect to login with error:\", parsedUrl.searchParams.get(\"error\"));\n                return url;\n            }\n            // If there's a specific callbackUrl (not login), use it\n            const callbackUrl = parsedUrl.searchParams.get(\"callbackUrl\");\n            if (callbackUrl && callbackUrl !== `${baseUrl}/login`) {\n                console.log(\"Using callbackUrl:\", callbackUrl);\n                return callbackUrl;\n            }\n            console.log(\"Default redirect to:\", url);\n            return url;\n        }\n    },\n    events: {\n        async signIn () {},\n        async signOut () {},\n        async createUser () {},\n        async updateUser () {},\n        async linkAccount () {},\n        async session () {}\n    },\n    debug: \"development\" === \"development\"\n};\nconst handler = next_auth__WEBPACK_IMPORTED_MODULE_0___default()(authOptions);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9hcHAvYXBpL2F1dGgvWy4uLm5leHRhdXRoXS9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztBQUFBOzs7Ozs7Ozs7Ozs7Ozs7O0NBZ0JDLEdBRWdDO0FBRXVCO0FBQ1U7QUFDUjtBQUNwQixDQUFDLGdDQUFnQztBQUN6QztBQUNOO0FBbUJ4QixNQUFNTyxvQkFBb0JELHlDQUFRLENBQUM7SUFDakNHLE9BQU9ILHlDQUFRLEdBQUdHLEtBQUs7SUFDdkJFLFVBQVVMLHlDQUFRLEdBQUdNLEdBQUcsQ0FBQztBQUMzQjtBQUVBLG9EQUFvRDtBQUNwRCxNQUFNQyxjQUFjLEtBQUssSUFBSSxzREFBc0Q7QUFDbkYsTUFBTUMsd0JBQXdCLElBQUksSUFBSSwwQ0FBMEM7QUFDaEYsTUFBTUMsa0JBQWtCLEtBQUssS0FBSyxLQUFLLElBQUksK0JBQStCO0FBQzFFLE1BQU1DLHFCQUFxQixLQUFLLEtBQUssSUFBSSxrQ0FBa0M7QUFFM0UsTUFBTUMsY0FBMkI7SUFDL0JDLFNBQVNmLHdFQUFhQSxDQUFDQywrQ0FBTUE7SUFDN0JlLFdBQVc7UUFDVGpCLDJFQUFtQkEsQ0FBQztZQUNsQmtCLE1BQU07WUFDTkMsYUFBYTtnQkFDWFosT0FBTztvQkFBRWEsT0FBTztvQkFBU0MsTUFBTTtvQkFBU0MsYUFBYTtnQkFBZ0I7Z0JBQ3JFYixVQUFVO29CQUFFVyxPQUFPO29CQUFTQyxNQUFNO2dCQUFXO1lBQy9DO1lBQ0EsTUFBTUUsV0FBVUosV0FBVztnQkFDekIsTUFBTUssU0FBU25CLGtCQUFrQm9CLFNBQVMsQ0FBQ047Z0JBQzNDLElBQUksQ0FBQ0ssT0FBT0UsT0FBTyxFQUFFO29CQUNuQixNQUFNLElBQUlDLE1BQU07Z0JBQ2xCO2dCQUNBLE1BQU0sRUFBRXBCLEtBQUssRUFBRUUsUUFBUSxFQUFFLEdBQUdlLE9BQU9JLElBQUk7Z0JBQ3ZDLE1BQU1DLE9BQU8sTUFBTTNCLCtDQUFNQSxDQUFDMkIsSUFBSSxDQUFDQyxVQUFVLENBQUM7b0JBQUVDLE9BQU87d0JBQUV4QjtvQkFBTTtnQkFBRTtnQkFFN0QsSUFBSSxDQUFDc0IsUUFBUSxDQUFDQSxLQUFLcEIsUUFBUSxFQUFFO29CQUMzQixNQUFNLElBQUlrQixNQUFNO2dCQUNsQjtnQkFDQSxNQUFNSyxVQUFVLE1BQU03Qix1REFBYyxDQUFDTSxVQUFVb0IsS0FBS3BCLFFBQVE7Z0JBQzVELElBQUksQ0FBQ3VCLFNBQVM7b0JBQ1osTUFBTSxJQUFJTCxNQUFNO2dCQUNsQjtnQkFDQSxrRUFBa0U7Z0JBQ2xFLE9BQU87b0JBQ0xPLElBQUlMLEtBQUtLLEVBQUU7b0JBQ1gzQixPQUFPc0IsS0FBS3RCLEtBQUs7b0JBQ2pCVyxNQUFNVyxLQUFLWCxJQUFJLElBQUksQ0FBQyxFQUFFVyxLQUFLTSxTQUFTLElBQUksR0FBRyxDQUFDLEVBQUVOLEtBQUtPLFFBQVEsSUFBSSxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxNQUFNO29CQUM5RUMsT0FBT1QsS0FBS1MsS0FBSztvQkFDakIsc0VBQXNFO29CQUN0RUgsV0FBV04sS0FBS00sU0FBUztvQkFDekJDLFVBQVVQLEtBQUtPLFFBQVE7b0JBQ3ZCRyxlQUFlVixLQUFLVSxhQUFhO29CQUNqQ0MsTUFBTVgsS0FBS1csSUFBSTtnQkFDakI7WUFDRjtRQUNGO1dBQ0lDLFFBQVFDLEdBQUcsQ0FBQ0MsZ0JBQWdCLElBQUlGLFFBQVFDLEdBQUcsQ0FBQ0Usb0JBQW9CLEdBQ2hFO1lBQUM3QyxzRUFBY0EsQ0FBQztnQkFDZDhDLFVBQVVKLFFBQVFDLEdBQUcsQ0FBQ0MsZ0JBQWdCO2dCQUN0Q0csY0FBY0wsUUFBUUMsR0FBRyxDQUFDRSxvQkFBb0I7Z0JBQzlDRyxlQUFlO29CQUNiQyxRQUFRO3dCQUFFQyxPQUFPO29CQUF1QjtnQkFDMUM7Z0JBQ0EsMERBQTBEO2dCQUMxRCxvRUFBb0U7Z0JBQ3BFQyxTQUFRQSxPQUF5QjtvQkFDL0Isc0VBQXNFO29CQUN0RSxPQUFPO3dCQUNMaEIsSUFBSWdCLFFBQVFDLEdBQUc7d0JBQ2ZqQyxNQUFNZ0MsUUFBUWhDLElBQUksSUFBSTt3QkFDdEJYLE9BQU8yQyxRQUFRM0MsS0FBSzt3QkFDcEIrQixPQUFPWSxRQUFRRSxPQUFPLElBQUk7d0JBQzFCLGlFQUFpRTt3QkFDakViLGVBQWVXLFFBQVFHLGNBQWMsR0FBRyxJQUFJQyxTQUFTO3dCQUNyRG5CLFdBQVdlLFFBQVFLLFVBQVUsSUFBSTt3QkFDakNuQixVQUFVYyxRQUFRTSxXQUFXLElBQUk7b0JBR25DO2dCQUNGO1lBQ0Y7U0FBRyxHQUNILEVBQUU7S0FDUDtJQUNEQyxTQUFTO1FBQ1BDLFVBQVU7UUFDVkMsUUFBUTlDO1FBQ1IrQyxXQUFXOUM7SUFDYjtJQUNBK0MsS0FBSztRQUNIRixRQUFRaEQ7SUFDVjtJQUNBbUQsT0FBTztRQUNMQyxRQUFRO1FBQ1JDLE9BQU87SUFDVDtJQUNBLHlDQUF5QztJQUN6Q0Msa0JBQWtCeEIsa0JBQXlCO0lBQzNDeUIsU0FBUztRQUNQQyxjQUFjO1lBQ1pqRCxNQUFNLENBQUMsRUFBRXVCLE1BQXFDLEdBQUcsQ0FBVyxHQUFHLEdBQUcsdUJBQXVCLENBQUM7WUFDMUYyQixTQUFTO2dCQUNQQyxVQUFVO2dCQUNWQyxVQUFVO2dCQUNWQyxNQUFNO2dCQUNOQyxRQUFRL0Isa0JBQXlCO1lBQ25DO1FBQ0Y7UUFDQWdDLGFBQWE7WUFDWHZELE1BQU0sQ0FBQyxFQUFFdUIsTUFBcUMsR0FBRyxDQUFXLEdBQUcsR0FBRyxzQkFBc0IsQ0FBQztZQUN6RjJCLFNBQVM7Z0JBQ1BDLFVBQVU7Z0JBQ1ZDLFVBQVU7Z0JBQ1ZDLE1BQU07Z0JBQ05DLFFBQVEvQixrQkFBeUI7WUFDbkM7UUFDRjtRQUNBaUMsV0FBVztZQUNUeEQsTUFBTSxDQUFDLEVBQUV1QixNQUFxQyxHQUFHLENBQVMsR0FBRyxHQUFHLG9CQUFvQixDQUFDO1lBQ3JGMkIsU0FBUztnQkFDUEMsVUFBVTtnQkFDVkMsVUFBVTtnQkFDVkMsTUFBTTtnQkFDTkMsUUFBUS9CLGtCQUF5QjtZQUNuQztRQUNGO0lBQ0Y7SUFDQWtDLFdBQVc7UUFDVCwrQ0FBK0M7UUFDL0MsTUFBTVosUUFBTyxFQUFFbEMsSUFBSSxFQUFFK0MsT0FBTyxFQUFFMUIsT0FBTyxFQUFFO1lBQ3JDLGdGQUFnRjtZQUNoRiwyR0FBMkc7WUFDM0csSUFBSTBCLFNBQVNDLGFBQWEsWUFBWTNCLFdBQVdyQixLQUFLSyxFQUFFLEVBQUU7Z0JBQ3hELE1BQU00QyxnQkFBZ0I1QjtnQkFFdEIsbURBQW1EO2dCQUNuRCxNQUFNNkIsZUFBb0IsQ0FBQyxHQUFHLHNDQUFzQztnQkFDcEUsSUFBSUQsY0FBYzFCLE9BQU8sSUFBSTBCLGNBQWMxQixPQUFPLEtBQUt2QixLQUFLUyxLQUFLLEVBQUV5QyxhQUFhekMsS0FBSyxHQUFHd0MsY0FBYzFCLE9BQU87Z0JBRTdHLE1BQU00Qix1QkFBdUJGLGNBQWN6QixjQUFjLEdBQUcsSUFBSUMsU0FBUztnQkFDekUsTUFBTTJCLG9CQUFvQnBELEtBQUtVLGFBQWE7Z0JBQzVDLHVEQUF1RDtnQkFDdkQsSUFBSXlDLHNCQUFzQkUsY0FBZUQsQ0FBQUEsNkJBQTZCM0IsT0FBTzJCLGtCQUFrQkMsT0FBTyxLQUFLLElBQUcsR0FBSTtvQkFDOUdILGFBQWF4QyxhQUFhLEdBQUd5QztnQkFDakM7Z0JBRUEsSUFBSUYsY0FBY3ZCLFVBQVUsSUFBSXVCLGNBQWN2QixVQUFVLEtBQUsxQixLQUFLTSxTQUFTLEVBQUU0QyxhQUFhNUMsU0FBUyxHQUFHMkMsY0FBY3ZCLFVBQVU7Z0JBQzlILElBQUl1QixjQUFjdEIsV0FBVyxJQUFJc0IsY0FBY3RCLFdBQVcsS0FBSzNCLEtBQUtPLFFBQVEsRUFBRTJDLGFBQWEzQyxRQUFRLEdBQUcwQyxjQUFjdEIsV0FBVztnQkFFL0gsbUNBQW1DO2dCQUNuQyxJQUFJc0IsY0FBYzVELElBQUksSUFBSTRELGNBQWM1RCxJQUFJLEtBQUtXLEtBQUtYLElBQUksRUFBRTtvQkFDeEQ2RCxhQUFhN0QsSUFBSSxHQUFHNEQsY0FBYzVELElBQUk7Z0JBQzFDO2dCQUVBLElBQUlpRSxPQUFPQyxJQUFJLENBQUNMLGNBQWNNLE1BQU0sR0FBRyxHQUFHO29CQUN4QyxJQUFJO3dCQUNGLE1BQU1uRiwrQ0FBTUEsQ0FBQzJCLElBQUksQ0FBQ3lELE1BQU0sQ0FBQzs0QkFDdkJ2RCxPQUFPO2dDQUFFRyxJQUFJTCxLQUFLSyxFQUFFOzRCQUFFOzRCQUN0Qk4sTUFBTW1EO3dCQUNSO29CQUNGLEVBQUUsT0FBT2YsT0FBTzt3QkFDZHVCLFFBQVF2QixLQUFLLENBQUMsMkNBQTJDQTtvQkFDM0Q7Z0JBQ0Y7WUFDRjtZQUNBLE9BQU8sTUFBTSxnQkFBZ0I7UUFDL0I7UUFDQSxNQUFNSCxLQUFJLEVBQUUyQixLQUFLLEVBQUUzRCxJQUFJLEVBQUU7WUFDdkIsTUFBTTRELE1BQU1DLEtBQUtDLEtBQUssQ0FBQ3JDLEtBQUttQyxHQUFHLEtBQUs7WUFFcEMsc0VBQXNFO1lBQ3RFLElBQUk1RCxNQUFNSyxJQUFJO2dCQUNaLHVDQUF1QztnQkFDdkNzRCxNQUFNdEQsRUFBRSxHQUFHTCxLQUFLSyxFQUFFO2dCQUNsQnNELE1BQU1JLEdBQUcsR0FBR0g7Z0JBQ1pELE1BQU1LLEdBQUcsR0FBR0osTUFBTTlFO2dCQUVsQixxRkFBcUY7Z0JBQ3JGLE1BQU1tRixTQUFTLE1BQU01RiwrQ0FBTUEsQ0FBQzJCLElBQUksQ0FBQ0MsVUFBVSxDQUFDO29CQUFFQyxPQUFPO3dCQUFFRyxJQUFJTCxLQUFLSyxFQUFFO29CQUFDO2dCQUFFO2dCQUNyRSxJQUFJNEQsUUFBUTtvQkFDVk4sTUFBTXRFLElBQUksR0FBRzRFLE9BQU81RSxJQUFJLElBQUksQ0FBQyxFQUFFNEUsT0FBTzNELFNBQVMsSUFBSSxHQUFHLENBQUMsRUFBRTJELE9BQU8xRCxRQUFRLElBQUksR0FBRyxDQUFDLENBQUNDLElBQUksTUFBTTtvQkFDM0ZtRCxNQUFNakYsS0FBSyxHQUFHdUYsT0FBT3ZGLEtBQUs7b0JBQzFCaUYsTUFBTXBDLE9BQU8sR0FBRzBDLE9BQU94RCxLQUFLO29CQUM1QmtELE1BQU1oRCxJQUFJLEdBQUdzRCxPQUFPdEQsSUFBSTtvQkFDeEJnRCxNQUFNckQsU0FBUyxHQUFHMkQsT0FBTzNELFNBQVM7b0JBQ2xDcUQsTUFBTXBELFFBQVEsR0FBRzBELE9BQU8xRCxRQUFRO29CQUNoQ29ELE1BQU1qRCxhQUFhLEdBQUd1RCxPQUFPdkQsYUFBYTtnQkFDNUMsT0FBTztvQkFDTCw4Q0FBOEM7b0JBQzlDaUQsTUFBTXRFLElBQUksR0FBR1csS0FBS1gsSUFBSSxJQUFJO29CQUMxQnNFLE1BQU1qRixLQUFLLEdBQUdzQixLQUFLdEIsS0FBSyxJQUFJO29CQUM1QmlGLE1BQU1wQyxPQUFPLEdBQUd2QixLQUFLUyxLQUFLLElBQUk7b0JBQzlCa0QsTUFBTWhELElBQUksR0FBR1gsS0FBS1csSUFBSSxJQUFJO29CQUMxQmdELE1BQU1yRCxTQUFTLEdBQUdOLEtBQUtNLFNBQVMsSUFBSTtvQkFDcENxRCxNQUFNcEQsUUFBUSxHQUFHUCxLQUFLTyxRQUFRLElBQUk7b0JBQ2xDb0QsTUFBTWpELGFBQWEsR0FBR1YsS0FBS1UsYUFBYSxJQUFJO2dCQUM5QztnQkFFQSxPQUFPaUQ7WUFDVDtZQUVBLGdGQUFnRjtZQUNoRixNQUFNTyxrQkFBa0IsTUFBT0YsR0FBRyxHQUFjSjtZQUVoRCxJQUFJTSxrQkFBa0JuRix1QkFBdUI7Z0JBQzNDMkUsUUFBUVMsR0FBRyxDQUFDLDZDQUE2QztvQkFDdkRDLGFBQWFSO29CQUNiUyxVQUFVVixNQUFNSyxHQUFHO29CQUNuQkU7b0JBQ0FJLFdBQVd2RjtnQkFDYjtnQkFFQSwyREFBMkQ7Z0JBQzNELE1BQU13RixXQUFXO29CQUNmLEdBQUdaLEtBQUs7b0JBQ1JJLEtBQUtIO29CQUNMSSxLQUFLSixNQUFNOUU7Z0JBQ2I7Z0JBRUEseURBQXlEO2dCQUN6RCxJQUFJNkUsTUFBTXRELEVBQUUsRUFBRTtvQkFDWixJQUFJO3dCQUNGLE1BQU00RCxTQUFTLE1BQU01RiwrQ0FBTUEsQ0FBQzJCLElBQUksQ0FBQ0MsVUFBVSxDQUFDOzRCQUFFQyxPQUFPO2dDQUFFRyxJQUFJc0QsTUFBTXRELEVBQUU7NEJBQVc7d0JBQUU7d0JBQ2hGLElBQUk0RCxRQUFROzRCQUNWTSxTQUFTbEYsSUFBSSxHQUFHNEUsT0FBTzVFLElBQUksSUFBSSxDQUFDLEVBQUU0RSxPQUFPM0QsU0FBUyxJQUFJLEdBQUcsQ0FBQyxFQUFFMkQsT0FBTzFELFFBQVEsSUFBSSxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxNQUFNOzRCQUM5RitELFNBQVM3RixLQUFLLEdBQUd1RixPQUFPdkYsS0FBSzs0QkFDN0I2RixTQUFTaEQsT0FBTyxHQUFHMEMsT0FBT3hELEtBQUs7NEJBQy9COEQsU0FBUzVELElBQUksR0FBR3NELE9BQU90RCxJQUFJOzRCQUMzQjRELFNBQVNqRSxTQUFTLEdBQUcyRCxPQUFPM0QsU0FBUzs0QkFDckNpRSxTQUFTaEUsUUFBUSxHQUFHMEQsT0FBTzFELFFBQVE7NEJBQ25DZ0UsU0FBUzdELGFBQWEsR0FBR3VELE9BQU92RCxhQUFhO3dCQUMvQztvQkFDRixFQUFFLE9BQU95QixPQUFPO3dCQUNkdUIsUUFBUXZCLEtBQUssQ0FBQyxxREFBcURBO29CQUNuRSxzREFBc0Q7b0JBQ3hEO2dCQUNGO2dCQUVBdUIsUUFBUVMsR0FBRyxDQUFDLGtDQUFrQztvQkFDNUNLLFFBQVFiLE1BQU1LLEdBQUc7b0JBQ2pCUyxRQUFRRixTQUFTUCxHQUFHO29CQUNwQlUsUUFBUUgsU0FBU1IsR0FBRztnQkFDdEI7Z0JBRUEsT0FBT1E7WUFDVDtZQUVBLHFDQUFxQztZQUNyQyxPQUFPWjtRQUNUO1FBQ0EsTUFBTS9CLFNBQVEsRUFBRUEsT0FBTyxFQUFFK0IsS0FBSyxFQUFFO1lBQzlCLHlFQUF5RTtZQUN6RSxJQUFJQSxTQUFTL0IsUUFBUTVCLElBQUksRUFBRTtnQkFDekI0QixRQUFRNUIsSUFBSSxDQUFDSyxFQUFFLEdBQUdzRCxNQUFNdEQsRUFBRTtnQkFDMUJ1QixRQUFRNUIsSUFBSSxDQUFDWCxJQUFJLEdBQUdzRSxNQUFNdEUsSUFBSTtnQkFDOUJ1QyxRQUFRNUIsSUFBSSxDQUFDdEIsS0FBSyxHQUFHaUYsTUFBTWpGLEtBQUs7Z0JBQ2hDa0QsUUFBUTVCLElBQUksQ0FBQ1MsS0FBSyxHQUFHa0QsTUFBTXBDLE9BQU87Z0JBQ2xDSyxRQUFRNUIsSUFBSSxDQUFDVyxJQUFJLEdBQUdnRCxNQUFNaEQsSUFBSTtnQkFDOUJpQixRQUFRNUIsSUFBSSxDQUFDTSxTQUFTLEdBQUdxRCxNQUFNckQsU0FBUztnQkFDeENzQixRQUFRNUIsSUFBSSxDQUFDTyxRQUFRLEdBQUdvRCxNQUFNcEQsUUFBUTtnQkFDdENxQixRQUFRNUIsSUFBSSxDQUFDVSxhQUFhLEdBQUdpRCxNQUFNakQsYUFBYTtnQkFFaEQsZ0RBQWdEO2dCQUNoRCxJQUFJRSxJQUFzQyxFQUFFO29CQUMxQ2dCLFFBQVErQyxLQUFLLEdBQUc7d0JBQ2RDLFVBQVVqQixNQUFNSSxHQUFHO3dCQUNuQk0sVUFBVVYsTUFBTUssR0FBRzt3QkFDbkJFLGlCQUFpQlAsTUFBTUssR0FBRyxHQUFHLE1BQU9BLEdBQUcsR0FBY0gsS0FBS0MsS0FBSyxDQUFDckMsS0FBS21DLEdBQUcsS0FBSyxRQUFRaUI7b0JBQ3ZGO2dCQUNGO1lBQ0Y7WUFDQSxPQUFPakQ7UUFDVDtRQUNBLE1BQU1rRCxVQUFTLEVBQUVDLEdBQUcsRUFBRUMsT0FBTyxFQUFFO1lBQzdCLE1BQU1DLFlBQVksSUFBSUMsSUFBSUgsS0FBS0M7WUFDL0J0QixRQUFRUyxHQUFHLENBQUMsQ0FBQyx3QkFBd0IsRUFBRVksSUFBSSxZQUFZLEVBQUVDLFFBQVEsYUFBYSxFQUFFQyxVQUFVRSxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBRXJHLDhGQUE4RjtZQUM5RixvR0FBb0c7WUFDcEcsSUFBSUYsVUFBVUUsUUFBUSxLQUFLLFlBQVlGLFVBQVVHLFlBQVksQ0FBQ0MsR0FBRyxDQUFDLGFBQWEsWUFBWTtnQkFDekYzQixRQUFRUyxHQUFHLENBQUM7Z0JBQ1osT0FBTyxDQUFDLEVBQUVhLFFBQVEsUUFBUSxDQUFDO1lBQzdCO1lBRUEsNkVBQTZFO1lBQzdFLElBQUlDLFVBQVVFLFFBQVEsS0FBSyxZQUFZLENBQUNGLFVBQVVHLFlBQVksQ0FBQ0UsR0FBRyxDQUFDLFVBQVU7Z0JBQzNFNUIsUUFBUVMsR0FBRyxDQUFDO2dCQUNaLE9BQU8sQ0FBQyxFQUFFYSxRQUFRLFFBQVEsQ0FBQztZQUM3QjtZQUVBLDZEQUE2RDtZQUM3RCxJQUFJQyxVQUFVRSxRQUFRLEtBQUssWUFBWUYsVUFBVUcsWUFBWSxDQUFDRSxHQUFHLENBQUMsVUFBVTtnQkFDMUU1QixRQUFRUyxHQUFHLENBQUMsMENBQTBDYyxVQUFVRyxZQUFZLENBQUNDLEdBQUcsQ0FBQztnQkFDakYsT0FBT047WUFDVDtZQUVBLHdEQUF3RDtZQUN4RCxNQUFNbkMsY0FBY3FDLFVBQVVHLFlBQVksQ0FBQ0MsR0FBRyxDQUFDO1lBQy9DLElBQUl6QyxlQUFlQSxnQkFBZ0IsQ0FBQyxFQUFFb0MsUUFBUSxNQUFNLENBQUMsRUFBRTtnQkFDckR0QixRQUFRUyxHQUFHLENBQUMsc0JBQXNCdkI7Z0JBQ2xDLE9BQU9BO1lBQ1Q7WUFFQWMsUUFBUVMsR0FBRyxDQUFDLHdCQUF3Qlk7WUFDcEMsT0FBT0E7UUFDVDtJQUNGO0lBQ0FRLFFBQVE7UUFDTixNQUFNckQsV0FBK0M7UUFDckQsTUFBTXNELFlBQWlEO1FBQ3ZELE1BQU1DLGVBQXVEO1FBQzdELE1BQU1DLGVBQXVEO1FBQzdELE1BQU1DLGdCQUF5RDtRQUMvRCxNQUFNL0QsWUFBaUQ7SUFDekQ7SUFDQStDLE9BQU8vRCxrQkFBeUI7QUFDbEM7QUFFQSxNQUFNZ0YsVUFBVTNILGdEQUFRQSxDQUFDaUI7QUFFa0IiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9jbGF1c2VkaWZmLS0tZG9jdW1lbnQtY29tcGFyaXNvbi10b29sLy4vYXBwL2FwaS9hdXRoL1suLi5uZXh0YXV0aF0vcm91dGUudHM/YzhhNCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEF1dGggcm91dGUgcGFyYSBhdXRlbnRpY2HDp8OjbyBjb20gTmV4dEF1dGggdjQgKE5leHQuanMgMTQgQXBwIFJvdXRlcikuXG4gKlxuICogUE9Mw41USUNBIERFIEFVRElUT1JJQSBFIExPR0dJTkc6XG4gKiAtIEVzdGUgZW5kcG9pbnQgaW1wbGVtZW50YSBsb2dnaW5nL2F1ZGl0b3JpYSBkZSBldmVudG9zIGRlIGF1dGVudGljYcOnw6NvIChsb2dpbiwgbG9nb3V0LCBmYWxoYSwgZXRjLilcbiAqICAgcGFyYSBmaW5zIGRlIHNlZ3VyYW7Dp2EsIHJhc3RyZWFiaWxpZGFkZSBlIGNvbXBsaWFuY2UgKExHUEQvR0RQUikuXG4gKiAtIE8gbG9nZ2luZyDDqSBjb250cm9sYWRvIHBlbGEgZmVhdHVyZSBmbGFnIGRlIGFtYmllbnRlIEFVRElUX0xPR0dJTkdfRU5BQkxFRC5cbiAqICAgLSBQYXJhIGF0aXZhcjogZGVmaW5hIEFVRElUX0xPR0dJTkdfRU5BQkxFRD1vbiBubyAuZW52XG4gKiAgIC0gUG9yIHBhZHLDo28sIG8gbG9nIGVzdMOhIERFU0xJR0FETyBwYXJhIGV2aXRhciBjdXN0b3MvZGVzZW1wZW5obyBubyBNVlAuXG4gKiAtIE9zIGV2ZW50b3Mgc8OjbyByZWdpc3RyYWRvcyBuYSB0YWJlbGEgQXVkaXRMb2cgZG8gYmFuY28gdmlhIFByaXNtYS5cbiAqIC0gRmFsaGFzIG5vIGxvZyBOw4NPIGFmZXRhbSBvIGZsdXhvIGRlIGF1dGVudGljYcOnw6NvLlxuICpcbiAqIFBhcmEgYXRpdmFyIG8gbG9naW4gR29vZ2xlIE9BdXRoLCBkZWZpbmEgR09PR0xFX0NMSUVOVF9JRCBlIEdPT0dMRV9DTElFTlRfU0VDUkVUIG5vIC5lbnZcbiAqIEV4ZW1wbG86XG4gKiAgIEdPT0dMRV9DTElFTlRfSUQ9eHh4eC5hcHBzLmdvb2dsZXVzZXJjb250ZW50LmNvbVxuICogICBHT09HTEVfQ0xJRU5UX1NFQ1JFVD14eHh4XG4gKi9cblxuaW1wb3J0IE5leHRBdXRoIGZyb20gXCJuZXh0LWF1dGhcIjtcbmltcG9ydCB0eXBlIHsgQXV0aE9wdGlvbnMsIFByb2ZpbGUgYXMgTmV4dEF1dGhQcm9maWxlIH0gZnJvbSBcIm5leHQtYXV0aFwiO1xuaW1wb3J0IEdvb2dsZVByb3ZpZGVyIGZyb20gXCJuZXh0LWF1dGgvcHJvdmlkZXJzL2dvb2dsZVwiO1xuaW1wb3J0IENyZWRlbnRpYWxzUHJvdmlkZXIgZnJvbSBcIm5leHQtYXV0aC9wcm92aWRlcnMvY3JlZGVudGlhbHNcIjtcbmltcG9ydCB7IFByaXNtYUFkYXB0ZXIgfSBmcm9tIFwiQG5leHQtYXV0aC9wcmlzbWEtYWRhcHRlclwiO1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSBcIkAvbGliL3ByaXNtYVwiOyAvLyBVc2Ugc2luZ2xldG9uIFByaXNtYSBpbnN0YW5jZVxuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCB7IHogfSBmcm9tIFwiem9kXCI7XG5cbi8vIEludGVyZmFjZSBmb3IgdGhlIFJBVyBwcm9maWxlIGRhdGEgZnJvbSBHb29nbGUsIHVzZWQgaW4gc2lnbkluIGNhbGxiYWNrIGFuZCBHb29nbGVQcm92aWRlci5wcm9maWxlXG5pbnRlcmZhY2UgUmF3R29vZ2xlUHJvZmlsZSBleHRlbmRzIE5leHRBdXRoUHJvZmlsZSB7IFxuICBuYW1lPzogc3RyaW5nO1xuICBlbWFpbD86IHN0cmluZztcbiAgcGljdHVyZT86IHN0cmluZztcbiAgZW1haWxfdmVyaWZpZWQ/OiBib29sZWFuOyBcbiAgZ2l2ZW5fbmFtZT86IHN0cmluZzsgICBcbiAgZmFtaWx5X25hbWU/OiBzdHJpbmc7ICBcbiAgc3ViOiBzdHJpbmc7IC8vICdzdWInIGlzIGd1YXJhbnRlZWQgZnJvbSBHb29nbGUgYW5kIGlzIHRoZSBJRFxuICBpc3M/OiBzdHJpbmc7XG4gIGF6cD86IHN0cmluZztcbiAgYXVkPzogc3RyaW5nO1xuICBhdF9oYXNoPzogc3RyaW5nO1xuICBpYXQ/OiBudW1iZXI7XG4gIGV4cD86IG51bWJlcjtcbn1cblxuY29uc3QgY3JlZGVudGlhbHNTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGVtYWlsOiB6LnN0cmluZygpLmVtYWlsKCksXG4gIHBhc3N3b3JkOiB6LnN0cmluZygpLm1pbig2KSxcbn0pO1xuXG4vLyBKV1QgdG9rZW4gY29uZmlndXJhdGlvbiBmb3Igc2VjdXJpdHkgYW5kIHJvdGF0aW9uXG5jb25zdCBKV1RfTUFYX0FHRSA9IDE1ICogNjA7IC8vIDE1IG1pbnV0ZXMgLSBzaG9ydC1saXZlZCBhY2Nlc3MgdG9rZW5zIGZvciBzZWN1cml0eVxuY29uc3QgSldUX1JFRlJFU0hfVEhSRVNIT0xEID0gNSAqIDYwOyAvLyA1IG1pbnV0ZXMgLSByZWZyZXNoIHdoZW4gNSBtaW51dGVzIGxlZnRcbmNvbnN0IFNFU1NJT05fTUFYX0FHRSA9IDMwICogMjQgKiA2MCAqIDYwOyAvLyAzMCBkYXlzIC0gbG9uZy1saXZlZCBzZXNzaW9uXG5jb25zdCBTRVNTSU9OX1VQREFURV9BR0UgPSAyNCAqIDYwICogNjA7IC8vIDI0IGhvdXJzIC0gdXBkYXRlIHNlc3Npb24gZGFpbHlcblxuY29uc3QgYXV0aE9wdGlvbnM6IEF1dGhPcHRpb25zID0ge1xuICBhZGFwdGVyOiBQcmlzbWFBZGFwdGVyKHByaXNtYSksXG4gIHByb3ZpZGVyczogW1xuICAgIENyZWRlbnRpYWxzUHJvdmlkZXIoe1xuICAgICAgbmFtZTogXCJFbWFpbCBlIFNlbmhhXCIsXG4gICAgICBjcmVkZW50aWFsczoge1xuICAgICAgICBlbWFpbDogeyBsYWJlbDogXCJFbWFpbFwiLCB0eXBlOiBcImVtYWlsXCIsIHBsYWNlaG9sZGVyOiBcInNldUBlbWFpbC5jb21cIiB9LFxuICAgICAgICBwYXNzd29yZDogeyBsYWJlbDogXCJTZW5oYVwiLCB0eXBlOiBcInBhc3N3b3JkXCIgfSxcbiAgICAgIH0sXG4gICAgICBhc3luYyBhdXRob3JpemUoY3JlZGVudGlhbHMpIHtcbiAgICAgICAgY29uc3QgcGFyc2VkID0gY3JlZGVudGlhbHNTY2hlbWEuc2FmZVBhcnNlKGNyZWRlbnRpYWxzKTtcbiAgICAgICAgaWYgKCFwYXJzZWQuc3VjY2Vzcykge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkNyZWRlbmNpYWlzIGludsOhbGlkYXNcIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHBhcnNlZC5kYXRhO1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgcHJpc21hLnVzZXIuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGVtYWlsIH0gfSk7XG5cbiAgICAgICAgaWYgKCF1c2VyIHx8ICF1c2VyLnBhc3N3b3JkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXN1w6FyaW8gb3Ugc2VuaGEgaW52w6FsaWRvc1wiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpO1xuICAgICAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVc3XDoXJpbyBvdSBzZW5oYSBpbnbDoWxpZG9zXCIpO1xuICAgICAgICB9XG4gICAgICAgIC8vIFJldHVybiBvYmplY3QgbXVzdCBtYXRjaCBOZXh0QXV0aC5Vc2VyIChhdWdtZW50ZWQgdmlhIHR5cGVzLnRzKVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiB1c2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIG5hbWU6IHVzZXIubmFtZSB8fCBgJHt1c2VyLmZpcnN0TmFtZSB8fCAnJ30gJHt1c2VyLmxhc3ROYW1lIHx8ICcnfWAudHJpbSgpIHx8IG51bGwsXG4gICAgICAgICAgaW1hZ2U6IHVzZXIuaW1hZ2UsXG4gICAgICAgICAgLy8gSW5jbHVkZSBvdGhlciBmaWVsZHMgZnJvbSBhdWdtZW50ZWQgVXNlciB0eXBlIGlmIGF2YWlsYWJsZSBkaXJlY3RseVxuICAgICAgICAgIGZpcnN0TmFtZTogdXNlci5maXJzdE5hbWUsXG4gICAgICAgICAgbGFzdE5hbWU6IHVzZXIubGFzdE5hbWUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIHJvbGU6IHVzZXIucm9sZSxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSksXG4gICAgLi4uKHByb2Nlc3MuZW52LkdPT0dMRV9DTElFTlRfSUQgJiYgcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9TRUNSRVRcbiAgICAgID8gW0dvb2dsZVByb3ZpZGVyKHtcbiAgICAgICAgICBjbGllbnRJZDogcHJvY2Vzcy5lbnYuR09PR0xFX0NMSUVOVF9JRCEsXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBwcm9jZXNzLmVudi5HT09HTEVfQ0xJRU5UX1NFQ1JFVCEsXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjoge1xuICAgICAgICAgICAgcGFyYW1zOiB7IHNjb3BlOiBcIm9wZW5pZCBlbWFpbCBwcm9maWxlXCIgfSxcbiAgICAgICAgICB9LFxuICAgICAgICAgIC8vIFVzZSBSYXdHb29nbGVQcm9maWxlIGZvciB0aGUgaW5wdXQgJ3Byb2ZpbGUnIHBhcmFtZXRlci5cbiAgICAgICAgICAvLyBUaGUgcmV0dXJuIHR5cGUgbXVzdCBjb25mb3JtIHRvIG91ciBhdWdtZW50ZWQgTmV4dEF1dGguVXNlciB0eXBlLlxuICAgICAgICAgIHByb2ZpbGUocHJvZmlsZTogUmF3R29vZ2xlUHJvZmlsZSkgeyBcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiR29vZ2xlIFByb2ZpbGUgaW4gR29vZ2xlUHJvdmlkZXIucHJvZmlsZTogXCIsIHByb2ZpbGUpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgaWQ6IHByb2ZpbGUuc3ViLCAvLyBUaGlzIG1hcHMgR29vZ2xlJ3MgJ3N1YicgdG8gTmV4dEF1dGgncyAnaWQnXG4gICAgICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSB8fCBudWxsLFxuICAgICAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCwgLy8gRW1haWwgaXMgZXhwZWN0ZWRcbiAgICAgICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZSB8fCBudWxsLFxuICAgICAgICAgICAgICAvLyBUaGVzZSBhcmUgdGhlIGN1c3RvbSBmaWVsZHMgd2UgYWRkZWQgdG8gb3VyIE5leHRBdXRoLlVzZXIgdHlwZVxuICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkID8gbmV3IERhdGUoKSA6IG51bGwsXG4gICAgICAgICAgICAgIGZpcnN0TmFtZTogcHJvZmlsZS5naXZlbl9uYW1lIHx8IG51bGwsXG4gICAgICAgICAgICAgIGxhc3ROYW1lOiBwcm9maWxlLmZhbWlseV9uYW1lIHx8IG51bGwsXG4gICAgICAgICAgICAgIC8vICdyb2xlJyBpcyBub3QgcHJvdmlkZWQgYnkgR29vZ2xlLiBJdCB3aWxsIGRlZmF1bHQgZnJvbSBQcmlzbWEgc2NoZW1hIG9uIHVzZXIgY3JlYXRpb24sXG4gICAgICAgICAgICAgIC8vIG9yIGJlIHBvcHVsYXRlZCBpbiBKV1Qvc2Vzc2lvbiBjYWxsYmFja3MgZnJvbSBEQi5cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSxcbiAgICAgICAgfSldXG4gICAgICA6IFtdKSxcbiAgXSxcbiAgc2Vzc2lvbjoge1xuICAgIHN0cmF0ZWd5OiBcImp3dFwiIGFzIGNvbnN0LFxuICAgIG1heEFnZTogU0VTU0lPTl9NQVhfQUdFLCAvLyAzMCBkYXlzIC0gcm9sbGluZyBzZXNzaW9uXG4gICAgdXBkYXRlQWdlOiBTRVNTSU9OX1VQREFURV9BR0UsIC8vIFVwZGF0ZSBzZXNzaW9uIGV2ZXJ5IDI0IGhvdXJzXG4gIH0sXG4gIGp3dDoge1xuICAgIG1heEFnZTogSldUX01BWF9BR0UsIC8vIDE1IG1pbnV0ZXMgLSBzaG9ydC1saXZlZCBmb3Igc2VjdXJpdHlcbiAgfSxcbiAgcGFnZXM6IHtcbiAgICBzaWduSW46IFwiL2xvZ2luXCIsXG4gICAgZXJyb3I6IFwiL2xvZ2luXCIsIFxuICB9LFxuICAvLyBFbmhhbmNlZCBDU1JGIHByb3RlY3Rpb24gY29uZmlndXJhdGlvblxuICB1c2VTZWN1cmVDb29raWVzOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIsXG4gIGNvb2tpZXM6IHtcbiAgICBzZXNzaW9uVG9rZW46IHtcbiAgICAgIG5hbWU6IGAke3Byb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIiA/IFwiX19TZWN1cmUtXCIgOiBcIlwifW5leHQtYXV0aC5zZXNzaW9uLXRva2VuYCxcbiAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgIHNhbWVTaXRlOiBcInN0cmljdFwiLFxuICAgICAgICBwYXRoOiBcIi9cIixcbiAgICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIsXG4gICAgICB9LFxuICAgIH0sXG4gICAgY2FsbGJhY2tVcmw6IHtcbiAgICAgIG5hbWU6IGAke3Byb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIiA/IFwiX19TZWN1cmUtXCIgOiBcIlwifW5leHQtYXV0aC5jYWxsYmFjay11cmxgLFxuICAgICAgb3B0aW9uczoge1xuICAgICAgICBodHRwT25seTogdHJ1ZSxcbiAgICAgICAgc2FtZVNpdGU6IFwic3RyaWN0XCIsXG4gICAgICAgIHBhdGg6IFwiL1wiLFxuICAgICAgICBzZWN1cmU6IHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIixcbiAgICAgIH0sXG4gICAgfSxcbiAgICBjc3JmVG9rZW46IHtcbiAgICAgIG5hbWU6IGAke3Byb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcInByb2R1Y3Rpb25cIiA/IFwiX19Ib3N0LVwiIDogXCJcIn1uZXh0LWF1dGguY3NyZi10b2tlbmAsXG4gICAgICBvcHRpb25zOiB7XG4gICAgICAgIGh0dHBPbmx5OiBmYWxzZSwgLy8gTXVzdCBiZSBhY2Nlc3NpYmxlIHRvIGNsaWVudCBmb3IgQ1NSRiBwcm90ZWN0aW9uXG4gICAgICAgIHNhbWVTaXRlOiBcInN0cmljdFwiLFxuICAgICAgICBwYXRoOiBcIi9cIixcbiAgICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJwcm9kdWN0aW9uXCIsXG4gICAgICB9LFxuICAgIH0sXG4gIH0sXG4gIGNhbGxiYWNrczoge1xuICAgIC8vIFVzZSB0aGUgc3RhbmRhcmQgTmV4dEF1dGggY2FsbGJhY2sgc2lnbmF0dXJlXG4gICAgYXN5bmMgc2lnbkluKHsgdXNlciwgYWNjb3VudCwgcHJvZmlsZSB9KSB7XG4gICAgICAvLyBGb3IgR29vZ2xlIE9BdXRoLCB1cGRhdGUgdXNlciB3aXRoIGxhdGVzdCBpbmZvIGZyb20gR29vZ2xlIHByb2ZpbGUgaWYgbmVlZGVkLlxuICAgICAgLy8gVGhlICd1c2VyJyBvYmplY3QgaGVyZSBzaG91bGQgYWxyZWFkeSBoYXZlIGFuICdpZCcgaWYgaXQncyBhbiBleGlzdGluZyB1c2VyIG9yIG5ld2x5IGNyZWF0ZWQgYnkgYWRhcHRlci5cbiAgICAgIGlmIChhY2NvdW50Py5wcm92aWRlciA9PT0gXCJnb29nbGVcIiAmJiBwcm9maWxlICYmIHVzZXIuaWQpIHtcbiAgICAgICAgY29uc3QgZ29vZ2xlUHJvZmlsZSA9IHByb2ZpbGUgYXMgUmF3R29vZ2xlUHJvZmlsZTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSB1c2VyIHdpdGggbGF0ZXN0IGluZm8gZnJvbSBHb29nbGUgcHJvZmlsZVxuICAgICAgICBjb25zdCBkYXRhVG9VcGRhdGU6IGFueSA9IHt9OyAvLyBVc2UgYW55IHRvIGF2b2lkIFByaXNtYSB0eXBlIGlzc3Vlc1xuICAgICAgICBpZiAoZ29vZ2xlUHJvZmlsZS5waWN0dXJlICYmIGdvb2dsZVByb2ZpbGUucGljdHVyZSAhPT0gdXNlci5pbWFnZSkgZGF0YVRvVXBkYXRlLmltYWdlID0gZ29vZ2xlUHJvZmlsZS5waWN0dXJlO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgcHJvZmlsZUVtYWlsVmVyaWZpZWQgPSBnb29nbGVQcm9maWxlLmVtYWlsX3ZlcmlmaWVkID8gbmV3IERhdGUoKSA6IG51bGw7XG4gICAgICAgIGNvbnN0IHVzZXJFbWFpbFZlcmlmaWVkID0gdXNlci5lbWFpbFZlcmlmaWVkO1xuICAgICAgICAvLyBDb21wYXJlIGRhdGVzIHByb3Blcmx5IG9yIGFsd2F5cyB1cGRhdGUgaWYgZGlmZmVyZW50XG4gICAgICAgIGlmIChwcm9maWxlRW1haWxWZXJpZmllZD8uZ2V0VGltZSgpICE9PSAodXNlckVtYWlsVmVyaWZpZWQgaW5zdGFuY2VvZiBEYXRlID8gdXNlckVtYWlsVmVyaWZpZWQuZ2V0VGltZSgpIDogbnVsbCkpIHtcbiAgICAgICAgICAgIGRhdGFUb1VwZGF0ZS5lbWFpbFZlcmlmaWVkID0gcHJvZmlsZUVtYWlsVmVyaWZpZWQ7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZ29vZ2xlUHJvZmlsZS5naXZlbl9uYW1lICYmIGdvb2dsZVByb2ZpbGUuZ2l2ZW5fbmFtZSAhPT0gdXNlci5maXJzdE5hbWUpIGRhdGFUb1VwZGF0ZS5maXJzdE5hbWUgPSBnb29nbGVQcm9maWxlLmdpdmVuX25hbWU7XG4gICAgICAgIGlmIChnb29nbGVQcm9maWxlLmZhbWlseV9uYW1lICYmIGdvb2dsZVByb2ZpbGUuZmFtaWx5X25hbWUgIT09IHVzZXIubGFzdE5hbWUpIGRhdGFUb1VwZGF0ZS5sYXN0TmFtZSA9IGdvb2dsZVByb2ZpbGUuZmFtaWx5X25hbWU7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgJ25hbWUnIGZpZWxkIGlmIGRpZmZlcmVudFxuICAgICAgICBpZiAoZ29vZ2xlUHJvZmlsZS5uYW1lICYmIGdvb2dsZVByb2ZpbGUubmFtZSAhPT0gdXNlci5uYW1lKSB7XG4gICAgICAgICAgICBkYXRhVG9VcGRhdGUubmFtZSA9IGdvb2dsZVByb2ZpbGUubmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChPYmplY3Qua2V5cyhkYXRhVG9VcGRhdGUpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgcHJpc21hLnVzZXIudXBkYXRlKHtcbiAgICAgICAgICAgICAgd2hlcmU6IHsgaWQ6IHVzZXIuaWQhIH0sXG4gICAgICAgICAgICAgIGRhdGE6IGRhdGFUb1VwZGF0ZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgdXNlciBpbiBzaWduSW4gY2FsbGJhY2s6XCIsIGVycm9yKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlOyAvLyBBbGxvdyBzaWduIGluXG4gICAgfSxcbiAgICBhc3luYyBqd3QoeyB0b2tlbiwgdXNlciB9KSB7XG4gICAgICBjb25zdCBub3cgPSBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKTtcbiAgICAgIFxuICAgICAgLy8gSWYgaXQncyBhIG5ldyB1c2VyIG9yIG5ldyBzaWduLWluLCAndXNlcicgb2JqZWN0IHdpbGwgYmUgYXZhaWxhYmxlLlxuICAgICAgaWYgKHVzZXI/LmlkKSB7XG4gICAgICAgIC8vIEZyZXNoIGxvZ2luIC0gc2V0IGluaXRpYWwgdG9rZW4gZGF0YVxuICAgICAgICB0b2tlbi5pZCA9IHVzZXIuaWQ7XG4gICAgICAgIHRva2VuLmlhdCA9IG5vdztcbiAgICAgICAgdG9rZW4uZXhwID0gbm93ICsgSldUX01BWF9BR0U7XG4gICAgICAgIFxuICAgICAgICAvLyBGZXRjaCB0aGUgY29tcGxldGUgdXNlciBmcm9tIERCIHRvIGVuc3VyZSBhbGwgZmllbGRzIGFyZSBmcmVzaCwgZXNwZWNpYWxseSAncm9sZScuXG4gICAgICAgIGNvbnN0IGRiVXNlciA9IGF3YWl0IHByaXNtYS51c2VyLmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZDogdXNlci5pZCB9IH0pO1xuICAgICAgICBpZiAoZGJVc2VyKSB7XG4gICAgICAgICAgdG9rZW4ubmFtZSA9IGRiVXNlci5uYW1lIHx8IGAke2RiVXNlci5maXJzdE5hbWUgfHwgJyd9ICR7ZGJVc2VyLmxhc3ROYW1lIHx8ICcnfWAudHJpbSgpIHx8IG51bGw7XG4gICAgICAgICAgdG9rZW4uZW1haWwgPSBkYlVzZXIuZW1haWw7XG4gICAgICAgICAgdG9rZW4ucGljdHVyZSA9IGRiVXNlci5pbWFnZTtcbiAgICAgICAgICB0b2tlbi5yb2xlID0gZGJVc2VyLnJvbGU7XG4gICAgICAgICAgdG9rZW4uZmlyc3ROYW1lID0gZGJVc2VyLmZpcnN0TmFtZTtcbiAgICAgICAgICB0b2tlbi5sYXN0TmFtZSA9IGRiVXNlci5sYXN0TmFtZTtcbiAgICAgICAgICB0b2tlbi5lbWFpbFZlcmlmaWVkID0gZGJVc2VyLmVtYWlsVmVyaWZpZWQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gRmFsbGJhY2sgdG8gdXNlciBvYmplY3QgaWYgZGJVc2VyIG5vdCBmb3VuZFxuICAgICAgICAgIHRva2VuLm5hbWUgPSB1c2VyLm5hbWUgfHwgbnVsbDtcbiAgICAgICAgICB0b2tlbi5lbWFpbCA9IHVzZXIuZW1haWwgfHwgbnVsbDtcbiAgICAgICAgICB0b2tlbi5waWN0dXJlID0gdXNlci5pbWFnZSB8fCBudWxsO1xuICAgICAgICAgIHRva2VuLnJvbGUgPSB1c2VyLnJvbGUgfHwgbnVsbDtcbiAgICAgICAgICB0b2tlbi5maXJzdE5hbWUgPSB1c2VyLmZpcnN0TmFtZSB8fCBudWxsO1xuICAgICAgICAgIHRva2VuLmxhc3ROYW1lID0gdXNlci5sYXN0TmFtZSB8fCBudWxsO1xuICAgICAgICAgIHRva2VuLmVtYWlsVmVyaWZpZWQgPSB1c2VyLmVtYWlsVmVyaWZpZWQgfHwgbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRva2VuO1xuICAgICAgfVxuXG4gICAgICAvLyBUb2tlbiByb3RhdGlvbiBsb2dpYzogQ2hlY2sgaWYgdG9rZW4gaXMgY2xvc2UgdG8gZXhwaXJ5IGFuZCByZWZyZXNoIGlmIG5lZWRlZFxuICAgICAgY29uc3QgdGltZVVudGlsRXhwaXJ5ID0gKHRva2VuLmV4cCBhcyBudW1iZXIpIC0gbm93O1xuICAgICAgXG4gICAgICBpZiAodGltZVVudGlsRXhwaXJ5IDwgSldUX1JFRlJFU0hfVEhSRVNIT0xEKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiSldUIHRva2VuIGlzIGNsb3NlIHRvIGV4cGlyeSwgcm90YXRpbmcuLi5cIiwge1xuICAgICAgICAgIGN1cnJlbnRUaW1lOiBub3csXG4gICAgICAgICAgdG9rZW5FeHA6IHRva2VuLmV4cCxcbiAgICAgICAgICB0aW1lVW50aWxFeHBpcnksXG4gICAgICAgICAgdGhyZXNob2xkOiBKV1RfUkVGUkVTSF9USFJFU0hPTERcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICAvLyBSb3RhdGUgdGhlIHRva2VuIGJ5IGNyZWF0aW5nIGEgbmV3IG9uZSB3aXRoIGZyZXNoIGV4cGlyeVxuICAgICAgICBjb25zdCBuZXdUb2tlbiA9IHtcbiAgICAgICAgICAuLi50b2tlbixcbiAgICAgICAgICBpYXQ6IG5vdyxcbiAgICAgICAgICBleHA6IG5vdyArIEpXVF9NQVhfQUdFLFxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgLy8gUmVmcmVzaCB1c2VyIGRhdGEgZnJvbSBkYXRhYmFzZSB0byBlbnN1cmUgaXQncyBjdXJyZW50XG4gICAgICAgIGlmICh0b2tlbi5pZCkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBkYlVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQ6IHRva2VuLmlkIGFzIHN0cmluZyB9IH0pO1xuICAgICAgICAgICAgaWYgKGRiVXNlcikge1xuICAgICAgICAgICAgICBuZXdUb2tlbi5uYW1lID0gZGJVc2VyLm5hbWUgfHwgYCR7ZGJVc2VyLmZpcnN0TmFtZSB8fCAnJ30gJHtkYlVzZXIubGFzdE5hbWUgfHwgJyd9YC50cmltKCkgfHwgbnVsbDtcbiAgICAgICAgICAgICAgbmV3VG9rZW4uZW1haWwgPSBkYlVzZXIuZW1haWw7XG4gICAgICAgICAgICAgIG5ld1Rva2VuLnBpY3R1cmUgPSBkYlVzZXIuaW1hZ2U7XG4gICAgICAgICAgICAgIG5ld1Rva2VuLnJvbGUgPSBkYlVzZXIucm9sZTtcbiAgICAgICAgICAgICAgbmV3VG9rZW4uZmlyc3ROYW1lID0gZGJVc2VyLmZpcnN0TmFtZTtcbiAgICAgICAgICAgICAgbmV3VG9rZW4ubGFzdE5hbWUgPSBkYlVzZXIubGFzdE5hbWU7XG4gICAgICAgICAgICAgIG5ld1Rva2VuLmVtYWlsVmVyaWZpZWQgPSBkYlVzZXIuZW1haWxWZXJpZmllZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHJlZnJlc2hpbmcgdXNlciBkYXRhIGR1cmluZyB0b2tlbiByb3RhdGlvbjpcIiwgZXJyb3IpO1xuICAgICAgICAgICAgLy8gQ29udGludWUgd2l0aCBleGlzdGluZyB0b2tlbiBkYXRhIGlmIERCIGZldGNoIGZhaWxzXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhcIkpXVCB0b2tlbiByb3RhdGVkIHN1Y2Nlc3NmdWxseVwiLCB7XG4gICAgICAgICAgb2xkRXhwOiB0b2tlbi5leHAsXG4gICAgICAgICAgbmV3RXhwOiBuZXdUb2tlbi5leHAsXG4gICAgICAgICAgbmV3SWF0OiBuZXdUb2tlbi5pYXRcbiAgICAgICAgfSk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbmV3VG9rZW47XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIFRva2VuIGlzIHN0aWxsIHZhbGlkLCByZXR1cm4gYXMtaXNcbiAgICAgIHJldHVybiB0b2tlbjtcbiAgICB9LFxuICAgIGFzeW5jIHNlc3Npb24oeyBzZXNzaW9uLCB0b2tlbiB9KSB7XG4gICAgICAvLyBTZW5kIHByb3BlcnRpZXMgdG8gdGhlIGNsaWVudCwgbGlrZSBpZCBhbmQgYW55IGN1c3RvbSB1c2VyIHByb3BlcnRpZXMuXG4gICAgICBpZiAodG9rZW4gJiYgc2Vzc2lvbi51c2VyKSB7XG4gICAgICAgIHNlc3Npb24udXNlci5pZCA9IHRva2VuLmlkIGFzIHN0cmluZztcbiAgICAgICAgc2Vzc2lvbi51c2VyLm5hbWUgPSB0b2tlbi5uYW1lIGFzIHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7XG4gICAgICAgIHNlc3Npb24udXNlci5lbWFpbCA9IHRva2VuLmVtYWlsIGFzIHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7XG4gICAgICAgIHNlc3Npb24udXNlci5pbWFnZSA9IHRva2VuLnBpY3R1cmUgYXMgc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgICAgICAgc2Vzc2lvbi51c2VyLnJvbGUgPSB0b2tlbi5yb2xlIGFzIHN0cmluZyB8IG51bGwgfCB1bmRlZmluZWQ7XG4gICAgICAgIHNlc3Npb24udXNlci5maXJzdE5hbWUgPSB0b2tlbi5maXJzdE5hbWUgYXMgc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgICAgICAgc2Vzc2lvbi51c2VyLmxhc3ROYW1lID0gdG9rZW4ubGFzdE5hbWUgYXMgc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZDtcbiAgICAgICAgc2Vzc2lvbi51c2VyLmVtYWlsVmVyaWZpZWQgPSB0b2tlbi5lbWFpbFZlcmlmaWVkIGFzIChEYXRlIHwgc3RyaW5nIHwgbnVsbCB8IHVuZGVmaW5lZCk7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgSldUIG1ldGFkYXRhIGZvciBkZWJ1Z2dpbmcgaW4gZGV2ZWxvcG1lbnRcbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIpIHtcbiAgICAgICAgICBzZXNzaW9uLmRlYnVnID0ge1xuICAgICAgICAgICAgdG9rZW5JYXQ6IHRva2VuLmlhdCBhcyBudW1iZXIgfCB1bmRlZmluZWQsXG4gICAgICAgICAgICB0b2tlbkV4cDogdG9rZW4uZXhwIGFzIG51bWJlciB8IHVuZGVmaW5lZCxcbiAgICAgICAgICAgIHRpbWVVbnRpbEV4cGlyeTogdG9rZW4uZXhwID8gKHRva2VuLmV4cCBhcyBudW1iZXIpIC0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgOiB1bmRlZmluZWQsXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIHNlc3Npb247XG4gICAgfSxcbiAgICBhc3luYyByZWRpcmVjdCh7IHVybCwgYmFzZVVybCB9KSB7XG4gICAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCwgYmFzZVVybCk7XG4gICAgICBjb25zb2xlLmxvZyhgUmVkaXJlY3QgY2FsbGJhY2s6IFVSTD0nJHt1cmx9JywgQmFzZVVSTD0nJHtiYXNlVXJsfScsIFBhdGhuYW1lPScke3BhcnNlZFVybC5wYXRobmFtZX0nYCk7XG4gICAgICBcbiAgICAgIC8vIElmIHdlJ3JlIGJlaW5nIHJlZGlyZWN0ZWQgdG8gL2xvZ2luIHdpdGggZXJyb3I9Q2FsbGJhY2ssIGJ1dCBhdXRoZW50aWNhdGlvbiB3YXMgc3VjY2Vzc2Z1bCxcbiAgICAgIC8vIHJlZGlyZWN0IHRvIHN1Y2Nlc3MgcGFnZSBpbnN0ZWFkLiBUaGUgXCJDYWxsYmFja1wiIGVycm9yIHNvbWV0aW1lcyBhcHBlYXJzIGV2ZW4gb24gc3VjY2Vzc2Z1bCBhdXRoLlxuICAgICAgaWYgKHBhcnNlZFVybC5wYXRobmFtZSA9PT0gXCIvbG9naW5cIiAmJiBwYXJzZWRVcmwuc2VhcmNoUGFyYW1zLmdldChcImVycm9yXCIpID09PSBcIkNhbGxiYWNrXCIpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJSZWRpcmVjdGluZyB0byBzdWNjZXNzIHBhZ2UgZGVzcGl0ZSBDYWxsYmFjayBlcnJvclwiKTtcbiAgICAgICAgcmV0dXJuIGAke2Jhc2VVcmx9L3N1Y2Nlc3NgO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBJZiB3ZSdyZSBiZWluZyByZWRpcmVjdGVkIHRvIC9sb2dpbiB3aXRob3V0IGV4cGxpY2l0IGVycm9ycywgZ28gdG8gc3VjY2Vzc1xuICAgICAgaWYgKHBhcnNlZFVybC5wYXRobmFtZSA9PT0gXCIvbG9naW5cIiAmJiAhcGFyc2VkVXJsLnNlYXJjaFBhcmFtcy5oYXMoXCJlcnJvclwiKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIlJlZGlyZWN0aW5nIHRvIHN1Y2Nlc3MgcGFnZSBmcm9tIGxvZ2luXCIpO1xuICAgICAgICByZXR1cm4gYCR7YmFzZVVybH0vc3VjY2Vzc2A7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIEZvciBhbnkgb3RoZXIgcmVkaXJlY3QgdG8gbG9naW4gd2l0aCByZWFsIGVycm9ycywgYWxsb3cgaXRcbiAgICAgIGlmIChwYXJzZWRVcmwucGF0aG5hbWUgPT09IFwiL2xvZ2luXCIgJiYgcGFyc2VkVXJsLnNlYXJjaFBhcmFtcy5oYXMoXCJlcnJvclwiKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhcIkFsbG93aW5nIHJlZGlyZWN0IHRvIGxvZ2luIHdpdGggZXJyb3I6XCIsIHBhcnNlZFVybC5zZWFyY2hQYXJhbXMuZ2V0KFwiZXJyb3JcIikpO1xuICAgICAgICByZXR1cm4gdXJsO1xuICAgICAgfVxuICAgICAgXG4gICAgICAvLyBJZiB0aGVyZSdzIGEgc3BlY2lmaWMgY2FsbGJhY2tVcmwgKG5vdCBsb2dpbiksIHVzZSBpdFxuICAgICAgY29uc3QgY2FsbGJhY2tVcmwgPSBwYXJzZWRVcmwuc2VhcmNoUGFyYW1zLmdldChcImNhbGxiYWNrVXJsXCIpO1xuICAgICAgaWYgKGNhbGxiYWNrVXJsICYmIGNhbGxiYWNrVXJsICE9PSBgJHtiYXNlVXJsfS9sb2dpbmApIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJVc2luZyBjYWxsYmFja1VybDpcIiwgY2FsbGJhY2tVcmwpO1xuICAgICAgICByZXR1cm4gY2FsbGJhY2tVcmw7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnNvbGUubG9nKFwiRGVmYXVsdCByZWRpcmVjdCB0bzpcIiwgdXJsKTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgfSxcbiAgZXZlbnRzOiB7XG4gICAgYXN5bmMgc2lnbkluKCkgeyAvKiBjb25zb2xlLmxvZyhcIkVWRU5UOiBzaWduSW5cIik7ICovIH0sXG4gICAgYXN5bmMgc2lnbk91dCgpIHsgLyogY29uc29sZS5sb2coXCJFVkVOVDogc2lnbk91dFwiKTsgKi8gfSxcbiAgICBhc3luYyBjcmVhdGVVc2VyKCkgeyAvKiBjb25zb2xlLmxvZyhcIkVWRU5UOiBjcmVhdGVVc2VyXCIpOyAqLyB9LFxuICAgIGFzeW5jIHVwZGF0ZVVzZXIoKSB7IC8qIGNvbnNvbGUubG9nKFwiRVZFTlQ6IHVwZGF0ZVVzZXJcIik7ICovIH0sXG4gICAgYXN5bmMgbGlua0FjY291bnQoKSB7IC8qIGNvbnNvbGUubG9nKFwiRVZFTlQ6IGxpbmtBY2NvdW50XCIpOyAqLyB9LFxuICAgIGFzeW5jIHNlc3Npb24oKSB7IC8qIGNvbnNvbGUubG9nKFwiRVZFTlQ6IHNlc3Npb25cIik7ICovIH0sXG4gIH0sXG4gIGRlYnVnOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJkZXZlbG9wbWVudFwiLFxufTtcblxuY29uc3QgaGFuZGxlciA9IE5leHRBdXRoKGF1dGhPcHRpb25zKTtcblxuZXhwb3J0IHsgaGFuZGxlciBhcyBHRVQsIGhhbmRsZXIgYXMgUE9TVCB9OyAiXSwibmFtZXMiOlsiTmV4dEF1dGgiLCJHb29nbGVQcm92aWRlciIsIkNyZWRlbnRpYWxzUHJvdmlkZXIiLCJQcmlzbWFBZGFwdGVyIiwicHJpc21hIiwiYmNyeXB0IiwieiIsImNyZWRlbnRpYWxzU2NoZW1hIiwib2JqZWN0IiwiZW1haWwiLCJzdHJpbmciLCJwYXNzd29yZCIsIm1pbiIsIkpXVF9NQVhfQUdFIiwiSldUX1JFRlJFU0hfVEhSRVNIT0xEIiwiU0VTU0lPTl9NQVhfQUdFIiwiU0VTU0lPTl9VUERBVEVfQUdFIiwiYXV0aE9wdGlvbnMiLCJhZGFwdGVyIiwicHJvdmlkZXJzIiwibmFtZSIsImNyZWRlbnRpYWxzIiwibGFiZWwiLCJ0eXBlIiwicGxhY2Vob2xkZXIiLCJhdXRob3JpemUiLCJwYXJzZWQiLCJzYWZlUGFyc2UiLCJzdWNjZXNzIiwiRXJyb3IiLCJkYXRhIiwidXNlciIsImZpbmRVbmlxdWUiLCJ3aGVyZSIsImlzVmFsaWQiLCJjb21wYXJlIiwiaWQiLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsInRyaW0iLCJpbWFnZSIsImVtYWlsVmVyaWZpZWQiLCJyb2xlIiwicHJvY2VzcyIsImVudiIsIkdPT0dMRV9DTElFTlRfSUQiLCJHT09HTEVfQ0xJRU5UX1NFQ1JFVCIsImNsaWVudElkIiwiY2xpZW50U2VjcmV0IiwiYXV0aG9yaXphdGlvbiIsInBhcmFtcyIsInNjb3BlIiwicHJvZmlsZSIsInN1YiIsInBpY3R1cmUiLCJlbWFpbF92ZXJpZmllZCIsIkRhdGUiLCJnaXZlbl9uYW1lIiwiZmFtaWx5X25hbWUiLCJzZXNzaW9uIiwic3RyYXRlZ3kiLCJtYXhBZ2UiLCJ1cGRhdGVBZ2UiLCJqd3QiLCJwYWdlcyIsInNpZ25JbiIsImVycm9yIiwidXNlU2VjdXJlQ29va2llcyIsImNvb2tpZXMiLCJzZXNzaW9uVG9rZW4iLCJvcHRpb25zIiwiaHR0cE9ubHkiLCJzYW1lU2l0ZSIsInBhdGgiLCJzZWN1cmUiLCJjYWxsYmFja1VybCIsImNzcmZUb2tlbiIsImNhbGxiYWNrcyIsImFjY291bnQiLCJwcm92aWRlciIsImdvb2dsZVByb2ZpbGUiLCJkYXRhVG9VcGRhdGUiLCJwcm9maWxlRW1haWxWZXJpZmllZCIsInVzZXJFbWFpbFZlcmlmaWVkIiwiZ2V0VGltZSIsIk9iamVjdCIsImtleXMiLCJsZW5ndGgiLCJ1cGRhdGUiLCJjb25zb2xlIiwidG9rZW4iLCJub3ciLCJNYXRoIiwiZmxvb3IiLCJpYXQiLCJleHAiLCJkYlVzZXIiLCJ0aW1lVW50aWxFeHBpcnkiLCJsb2ciLCJjdXJyZW50VGltZSIsInRva2VuRXhwIiwidGhyZXNob2xkIiwibmV3VG9rZW4iLCJvbGRFeHAiLCJuZXdFeHAiLCJuZXdJYXQiLCJkZWJ1ZyIsInRva2VuSWF0IiwidW5kZWZpbmVkIiwicmVkaXJlY3QiLCJ1cmwiLCJiYXNlVXJsIiwicGFyc2VkVXJsIiwiVVJMIiwicGF0aG5hbWUiLCJzZWFyY2hQYXJhbXMiLCJnZXQiLCJoYXMiLCJldmVudHMiLCJzaWduT3V0IiwiY3JlYXRlVXNlciIsInVwZGF0ZVVzZXIiLCJsaW5rQWNjb3VudCIsImhhbmRsZXIiLCJHRVQiLCJQT1NUIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/auth/[...nextauth]/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/prisma.ts":
/*!***************************!*\
  !*** ./src/lib/prisma.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient({\n    log:  true ? [\n        \"query\",\n        \"info\",\n        \"warn\",\n        \"error\"\n    ] : 0,\n    datasources: {\n        db: {\n            url: process.env.DATABASE_URL\n        }\n    }\n});\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3ByaXNtYS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7QUFBOEM7QUFFOUMsTUFBTUMsa0JBQWtCQztBQUlqQixNQUFNQyxTQUFTRixnQkFBZ0JFLE1BQU0sSUFBSSxJQUFJSCx3REFBWUEsQ0FBQztJQUMvREksS0FBS0MsS0FBeUIsR0FBZ0I7UUFBQztRQUFTO1FBQVE7UUFBUTtLQUFRLEdBQUcsQ0FBUztJQUM1RkMsYUFBYTtRQUNYQyxJQUFJO1lBQ0ZDLEtBQUtILFFBQVFJLEdBQUcsQ0FBQ0MsWUFBWTtRQUMvQjtJQUNGO0FBQ0YsR0FBRztBQUVILElBQUlMLElBQXlCLEVBQWNKLGdCQUFnQkUsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsid2VicGFjazovL2NsYXVzZWRpZmYtLS1kb2N1bWVudC1jb21wYXJpc29uLXRvb2wvLi9zcmMvbGliL3ByaXNtYS50cz8wMWQ3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50JztcblxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcbiAgcHJpc21hOiBQcmlzbWFDbGllbnQgfCB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/PyBuZXcgUHJpc21hQ2xpZW50KHtcbiAgbG9nOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ2RldmVsb3BtZW50JyA/IFsncXVlcnknLCAnaW5mbycsICd3YXJuJywgJ2Vycm9yJ10gOiBbJ2Vycm9yJ10sXG4gIGRhdGFzb3VyY2VzOiB7XG4gICAgZGI6IHtcbiAgICAgIHVybDogcHJvY2Vzcy5lbnYuREFUQUJBU0VfVVJMXG4gICAgfVxuICB9XG59KTtcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWE7ICJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwibG9nIiwicHJvY2VzcyIsImRhdGFzb3VyY2VzIiwiZGIiLCJ1cmwiLCJlbnYiLCJEQVRBQkFTRV9VUkwiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/prisma.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/next-auth","vendor-chunks/@babel","vendor-chunks/zod","vendor-chunks/bcryptjs","vendor-chunks/jose","vendor-chunks/openid-client","vendor-chunks/uuid","vendor-chunks/oauth","vendor-chunks/@panva","vendor-chunks/preact-render-to-string","vendor-chunks/oidc-token-hash","vendor-chunks/preact","vendor-chunks/object-hash","vendor-chunks/cookie","vendor-chunks/@next-auth"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&page=%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fauth%2F%5B...nextauth%5D%2Froute.ts&appDir=%2FUsers%2Fviniciusalbino%2FDocuments%2FGitHub%2Fclausediff.nosync%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fviniciusalbino%2FDocuments%2FGitHub%2Fclausediff.nosync&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();