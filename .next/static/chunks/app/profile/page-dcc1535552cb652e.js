(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{9719:function(e,s,t){Promise.resolve().then(t.bind(t,7083))},7083:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return c}});var r=t(7437),a=t(2265),l=t(998),d=t(6463),i=t(7138),o=t(6700);let n=o.z.object({firstName:o.z.string().min(1,"Nome \xe9 obrigat\xf3rio").max(50,"Nome deve ter no m\xe1ximo 50 caracteres"),lastName:o.z.string().min(1,"Sobrenome \xe9 obrigat\xf3rio").max(50,"Sobrenome deve ter no m\xe1ximo 50 caracteres"),email:o.z.string().email("Email inv\xe1lido").toLowerCase(),city:o.z.string().max(100,"Cidade deve ter no m\xe1ximo 100 caracteres").optional().or(o.z.literal("")),state:o.z.string().max(50,"Estado deve ter no m\xe1ximo 50 caracteres").optional().or(o.z.literal("")),cpf:o.z.string().optional().or(o.z.literal("")).refine(e=>!e||11===e.replace(/\D/g,"").length,"CPF deve ter 11 d\xedgitos")});function c(){var e,s;let{data:t,status:c,update:m}=(0,l.useSession)(),u=(0,d.useRouter)(),[x,f]=(0,a.useState)({firstName:"",lastName:"",email:"",city:"",state:"",cpf:""}),[g,h]=(0,a.useState)({}),[b,p]=(0,a.useState)(!1),[y,N]=(0,a.useState)(!1),[j,v]=(0,a.useState)(""),[w,k]=(0,a.useState)("");(0,a.useEffect)(()=>{if("loading"!==c&&"unauthenticated"===c){u.push("/login");return}},[c,u]),(0,a.useEffect)(()=>{(null==t?void 0:t.user)&&f({firstName:t.user.firstName||"",lastName:t.user.lastName||"",email:t.user.email||"",city:t.user.city||"",state:t.user.state||"",cpf:t.user.cpf||""})},[t]);let C=e=>{let{name:s,value:t}=e.target;if("cpf"===s){let e=t.replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4");f(t=>({...t,[s]:e}))}else f(e=>({...e,[s]:t}));g[s]&&h(e=>({...e,[s]:""})),j&&v(""),w&&k("")},z=()=>{try{return n.parse(x),h({}),!0}catch(e){if(e instanceof o.z.ZodError){let s={};e.errors.forEach(e=>{e.path[0]&&(s[e.path[0]]=e.message)}),h(s)}return!1}},S=async e=>{if(e.preventDefault(),z()){p(!0),v(""),k("");try{let e=await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}),s=await e.json();e.ok?(k("Perfil atualizado com sucesso!"),N(!1),await m({...t,user:{...null==t?void 0:t.user,...x}})):v(s.details||s.error||"Erro ao atualizar perfil")}catch(e){v("Erro de conex\xe3o. Tente novamente.")}finally{p(!1)}}},E=async()=>{await (0,l.signOut)({callbackUrl:"/login"})};return"loading"===c?(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsxs)("svg",{className:"animate-spin mx-auto h-12 w-12 text-blue-600",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,r.jsx)("h2",{className:"mt-4 text-xl font-semibold text-gray-900",children:"Carregando..."})]})}):"unauthenticated"===c?null:(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,r.jsx)("div",{className:"bg-white shadow sm:rounded-lg mb-6",children:(0,r.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Meu Perfil"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"Gerencie suas informa\xe7\xf5es pessoais e configura\xe7\xf5es de conta"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)(i.default,{href:"/dashboard",className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Dashboard"}),(0,r.jsx)("button",{onClick:E,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:"Sair"})]})]})})}),(0,r.jsx)("div",{className:"bg-white shadow sm:rounded-lg",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Informa\xe7\xf5es Pessoais"}),!y&&(0,r.jsxs)("button",{onClick:()=>N(!0),className:"inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,r.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Editar"]})]}),w&&(0,r.jsx)("div",{className:"mb-4 rounded-md bg-green-50 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("p",{className:"text-sm text-green-800",children:w})})]})}),j&&(0,r.jsx)("div",{className:"mb-4 rounded-md bg-red-50 p-4",children:(0,r.jsxs)("div",{className:"flex",children:[(0,r.jsx)("div",{className:"flex-shrink-0",children:(0,r.jsx)("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),(0,r.jsx)("div",{className:"ml-3",children:(0,r.jsx)("p",{className:"text-sm text-red-800",children:j})})]})}),(0,r.jsxs)("form",{onSubmit:S,className:"space-y-6",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-gray-700",children:"Nome *"}),(0,r.jsx)("input",{type:"text",id:"firstName",name:"firstName",value:x.firstName,onChange:C,disabled:!y||b,className:"mt-1 block w-full px-3 py-2 border ".concat(g.firstName?"border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"," rounded-md shadow-sm sm:text-sm ").concat(y?"bg-white":"bg-gray-50 text-gray-500"," disabled:bg-gray-50 disabled:text-gray-500")}),g.firstName&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.firstName})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-gray-700",children:"Sobrenome *"}),(0,r.jsx)("input",{type:"text",id:"lastName",name:"lastName",value:x.lastName,onChange:C,disabled:!y||b,className:"mt-1 block w-full px-3 py-2 border ".concat(g.lastName?"border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"," rounded-md shadow-sm sm:text-sm ").concat(y?"bg-white":"bg-gray-50 text-gray-500"," disabled:bg-gray-50 disabled:text-gray-500")}),g.lastName&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.lastName})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",value:x.email,disabled:!0,className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-50 text-gray-500 sm:text-sm"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"O email n\xe3o pode ser alterado por quest\xf5es de seguran\xe7a"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700",children:"Cidade"}),(0,r.jsx)("input",{type:"text",id:"city",name:"city",value:x.city,onChange:C,disabled:!y||b,className:"mt-1 block w-full px-3 py-2 border ".concat(g.city?"border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"," rounded-md shadow-sm sm:text-sm ").concat(y?"bg-white":"bg-gray-50 text-gray-500"," disabled:bg-gray-50 disabled:text-gray-500")}),g.city&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.city})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"state",className:"block text-sm font-medium text-gray-700",children:"Estado"}),(0,r.jsx)("input",{type:"text",id:"state",name:"state",value:x.state,onChange:C,disabled:!y||b,className:"mt-1 block w-full px-3 py-2 border ".concat(g.state?"border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"," rounded-md shadow-sm sm:text-sm ").concat(y?"bg-white":"bg-gray-50 text-gray-500"," disabled:bg-gray-50 disabled:text-gray-500")}),g.state&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.state})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"cpf",className:"block text-sm font-medium text-gray-700",children:"CPF"}),(0,r.jsx)("input",{type:"text",id:"cpf",name:"cpf",value:x.cpf,onChange:C,disabled:!y||b,placeholder:"000.000.000-00",maxLength:14,className:"mt-1 block w-full px-3 py-2 border ".concat(g.cpf?"border-red-300 text-red-900 placeholder-red-300 focus:outline-none focus:ring-red-500 focus:border-red-500":"border-gray-300 focus:ring-blue-500 focus:border-blue-500"," rounded-md shadow-sm sm:text-sm ").concat(y?"bg-white":"bg-gray-50 text-gray-500"," disabled:bg-gray-50 disabled:text-gray-500")}),g.cpf&&(0,r.jsx)("p",{className:"mt-1 text-sm text-red-600",children:g.cpf})]}),y&&(0,r.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,r.jsx)("button",{type:"button",onClick:()=>{(null==t?void 0:t.user)&&f({firstName:t.user.firstName||"",lastName:t.user.lastName||"",email:t.user.email||"",city:t.user.city||"",state:t.user.state||"",cpf:t.user.cpf||""}),h({}),v(""),k(""),N(!1)},disabled:b,className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),(0,r.jsx)("button",{type:"submit",disabled:b,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:b?(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]}):"Salvar Altera\xe7\xf5es"})]})]})]})}),(0,r.jsx)("div",{className:"bg-white shadow sm:rounded-lg mt-6",children:(0,r.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informa\xe7\xf5es da Conta"}),(0,r.jsxs)("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Tipo de Conta"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:(null==t?void 0:null===(e=t.user)||void 0===e?void 0:e.role)==="ADMIN"?"Administrador":"Usu\xe1rio"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Email Verificado"}),(0,r.jsx)("dd",{className:"mt-1 text-sm text-gray-900",children:(null==t?void 0:null===(s=t.user)||void 0===s?void 0:s.emailVerified)?"Sim":"N\xe3o"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("dt",{className:"text-sm font-medium text-gray-500",children:"Status da Conta"}),(0,r.jsx)("dd",{className:"mt-1",children:(0,r.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Ativa"})})]})]})]})})]})})}},7138:function(e,s,t){"use strict";t.d(s,{default:function(){return a.a}});var r=t(231),a=t.n(r)},6463:function(e,s,t){"use strict";var r=t(1169);t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[231,998,700,971,23,744],function(){return e(e.s=9719)}),_N_E=e.O()}]);